!function(e,a){"use strict";if(storageOK&&(localStorage.GenkiEdition=/lessons-3rd/.test(e.location.pathname)?"3rd":"2nd"),a.getElementById("quick-search")){if(e.QuickSearcher={grammarIndex:/grammar-index/.test(e.location.pathname),search:a.getElementById("quick-search"),results:a.getElementById("quick-search-results"),hitsCounter:a.getElementById("quick-search-hits"),li:null,exLen:null,query:function(t){QuickSearcher.timeout&&clearTimeout(QuickSearcher.timeout),QuickSearcher.timeout=setTimeout(function(){var r,s=a.createDocumentFragment(),n=0,c=0;if(QuickSearcher.results.innerHTML="",t)for(;c<QuickSearcher.exLen;c++)(-1!=QuickSearcher.li[c].innerHTML.replace(/||<.*?>/g,"").toLowerCase().indexOf(t.toLowerCase())||QuickSearcher.li[c].dataset&&QuickSearcher.li[c].dataset.keywords&&-1!=QuickSearcher.li[c].dataset.keywords.toLowerCase().indexOf(t.toLowerCase()))&&QuickSearcher.li[c].getElementsByTagName("A")[0]&&!/note/.test(QuickSearcher.li[c].id)&&(QuickSearcher.grammarIndex?(r=a.createElement("LI")).innerHTML='<a href="#'+QuickSearcher.li[c].id+'">'+QuickSearcher.li[c].innerHTML.replace(/||<a.*?>.*?<\/a>/g,"")+"</a>":r=QuickSearcher.li[c].cloneNode(!0),r.dataset.lesson=QuickSearcher.grammarIndex?"L"+QuickSearcher.li[c].id.replace(/l(\d+)-.*/,"$1"):r.getElementsByTagName("A")[0].href.replace(/.*?\/(lesson-\d+).*|.*?\/(study-tools).*|.*?\/(appendix).*/,function(e,a,t,r){return a?a.charAt(0).toUpperCase()+a.split("-").pop():t?"tool":r?"appendix":void 0}),r.title=r.innerText,/^file|^http/.test(r.dataset.lesson)||(s.appendChild(r),n++));s.childNodes.length?QuickSearcher.results.appendChild(s):QuickSearcher.results.innerHTML=t?'<li><span class="en">No results found for "'+t+'".</span><span class="ja">「'+t+"」が見つかりませんでした。</span></li>":"",QuickSearcher.hitsCounter.innerHTML=n?"("+n+') <a class="fa" style="color:#F93;" href="#copy-search-link" title="'+("ja"==GenkiLang?"サーチリンクをコピーする":"Copy the search link")+"\" onclick=\"GenkiModal.open({title : '<span class=&quot;en&quot;>Copy Search Link</span><span class=&quot;ja&quot;>サーチリンクをコピーする</span>',content : '<div class=&quot;center&quot;><p><span class=&quot;en&quot;>You can copy the direct search link from the box below.</span><span class=&quot;ja&quot;>下の箱からサーチリンクがコピーできます。</span></p><textarea id=&quot;copied-search-link&quot; onfocus=&quot;this.select();&quot; style=&quot;width:80%;height:100px;&quot;>"+e.location.protocol+"//"+e.location.host+e.location.pathname+"?search="+encodeURIComponent(t)+"#quick-search-exercises</textarea></div>',focus : '#copied-search-link'}); return false;\">&#xf0ea;</a>":"",delete QuickSearcher.timeout},300)}},QuickSearcher.li=a.querySelectorAll(QuickSearcher.grammarIndex?".workbook-title":".lesson-exercises li"),QuickSearcher.exLen=QuickSearcher.li.length,e.location.search)for(var t,r=e.location.search.slice(1).split("&"),s=0,n=r.length;s<n;s++)if(t=r[s].split("="),/^search$/i.test(t[0])){QuickSearcher.search.value=decodeURIComponent(t[1]);break}QuickSearcher.search.oninput=function(){QuickSearcher.query(this.value)},QuickSearcher.search.value&&QuickSearcher.query(QuickSearcher.search.value)}s=0,n=(l=a.querySelectorAll("#quick-nav-list a")).length;for(var c,i=/grammar-index/.test(e.location.pathname)?/.*?lesson-grammar-(\d+).*/:/.*?lesson-(\d+).*/;s<n;s++)/lesson-\d+|lesson-grammar-\d+/.test(l[s])&&(c=l[s].href.replace(i,"$1"),l[s].insertAdjacentHTML("beforebegin",'<a class="sub-section-button fa" href="#toggle-sub-section" onclick="ToggleSubSection(this, '+c+'); return false;" title="'+("ja"==GenkiLang?"サブセクションをトグルする":"Toggle sub-sections")+'" data-open="false"></a>'),l[s].insertAdjacentHTML("afterend",'<ul style="display:none;"></ul>'),l[s].parentNode.className+=" noBullet");if(e.ToggleSubSection=function(e,t){var r=e.parentNode.lastChild;if(!r.innerHTML){for(var s=a.querySelectorAll("#exercises-"+t+" h3"),n=0,c=s.length,i="";n<c;n++)i+='<li><a href="#'+s[n].id+'">'+s[n].innerHTML.replace(/\s\(.*\)$/,"").replace(/<a.*?>.*?<\/a>/g,"")+"</a></li>";r.innerHTML=i}/none/.test(r.style.display)?(r.style.display="block",e.dataset.open=!0):(r.style.display="none",e.dataset.open=!1)},AddJumpArrowsTo(".lesson-title","quick-nav","ja"==GenkiLang?"クイックナビゲーションに戻る":"Jump to Quick Navigation"),storageOK&&localStorage.Results){var o,l,u=JSON.parse(localStorage.Results)[/lessons-3rd/.test(e.location.pathname)?"3rd":"2nd"];for(o in u)(l=a.querySelector('a[href*="'+o+'"]'))&&l.parentNode.insertAdjacentHTML("beforeend",'&nbsp;<span class="exercise-results result--'+(100==u[o]?"perfect":u[o]>=70?"good":u[o]>=50?"average":"low")+'" title="'+("ja"==GenkiLang?"テストの得点":"Exercise score")+'"><i class="fa">'+(100==u[o]?"&#xf005;":u[o]>=70?"&#xf00c;":u[o]>=50?"&#xf10c;":"&#xf00d;")+"</i> "+u[o]+"%</span>")}}(window,document);