!function(e,r){"use strict";if(storageOK&&(localStorage.GenkiEdition=/lessons-3rd/.test(e.location.pathname)?"3rd":"2nd"),r.getElementById("quick-search")){if(e.QuickSearcher={grammarIndex:/grammar-index/.test(e.location.href),search:r.getElementById("quick-search"),results:r.getElementById("quick-search-results"),hitsCounter:r.getElementById("quick-search-hits"),li:null,exLen:null,query:function(t){e.GenkiSearchTimeout&&e.clearTimeout(GenkiSearchTimeout),e.GenkiSearchTimeout=e.setTimeout(function(){var a,i=r.createDocumentFragment(),c=0,n=0;if(QuickSearcher.results.innerHTML="",t)for(;n<QuickSearcher.exLen;n++)(-1!=QuickSearcher.li[n].innerHTML.replace(/||<.*?>/g,"").toLowerCase().indexOf(t.toLowerCase())||QuickSearcher.li[n].dataset&&QuickSearcher.li[n].dataset.keywords&&-1!=QuickSearcher.li[n].dataset.keywords.toLowerCase().indexOf(t.toLowerCase()))&&QuickSearcher.li[n].getElementsByTagName("A")[0]&&!/note/.test(QuickSearcher.li[n].id)&&(QuickSearcher.grammarIndex?(a=r.createElement("LI")).innerHTML='<a href="#'+QuickSearcher.li[n].id+'">'+QuickSearcher.li[n].innerHTML.replace(/||<a.*?>.*?<\/a>/g,"")+"</a>":a=QuickSearcher.li[n].cloneNode(!0),a.dataset.lesson=QuickSearcher.grammarIndex?"L"+QuickSearcher.li[n].id.replace(/l(\d+)-p\d+/,"$1"):a.getElementsByTagName("A")[0].href.replace(/.*?\/(lesson-\d+).*|.*?\/(study-tools).*|.*?\/(appendix).*/,function(e,r,t,a){return r?r.charAt(0).toUpperCase()+r.split("-").pop():t?"tool":a?"appendix":void 0}),a.title=a.innerText,/^file|^http/.test(a.dataset.lesson)||(i.appendChild(a),c++));i.childNodes.length?QuickSearcher.results.appendChild(i):QuickSearcher.results.innerHTML=t?'<li>No results found for "'+t+'".</li>':"",QuickSearcher.hitsCounter.innerHTML=c?"("+c+') <a class="fa" style="color:#F93;" href="#copy-search-link" title="Copy the search link" onclick="GenkiModal.open({title : \'Copy Search Link\',content : \'<div class=&quot;center&quot;><p>You can copy the direct search link from the box below.</p><textarea id=&quot;copied-search-link&quot; onfocus=&quot;this.select();&quot; style=&quot;width:80%;height:100px;&quot;>'+e.location.protocol+"//"+e.location.host+e.location.pathname+"?search="+encodeURIComponent(t)+"#quick-search-exercises</textarea></div>',focus : '#copied-search-link'}); return false;\">&#xf0ea;</a>":"",delete e.GenkiSearchTimeout},300)}},QuickSearcher.li=r.querySelectorAll(QuickSearcher.grammarIndex?".workbook-title":".lesson-exercises li"),QuickSearcher.exLen=QuickSearcher.li.length,e.location.search)for(var t,a=e.location.search.slice(1).split("&"),i=0,c=a.length;i<c;i++)if(t=a[i].split("="),/^search$/i.test(t[0])){QuickSearcher.search.value=decodeURIComponent(t[1]);break}QuickSearcher.search.oninput=function(){QuickSearcher.query(this.value)},QuickSearcher.search.value&&QuickSearcher.query(QuickSearcher.search.value)}var n;for(i=0,c=(s=r.querySelectorAll("#quick-nav-list a")).length;i<c;i++)/lesson-(?:grammar-|)\d+/.test(s[i])&&(n=s[i].href.replace(/.*?lesson-(?:grammar-|)(\d+).*/,"$1"),s[i].insertAdjacentHTML("beforebegin",'<a class="sub-section-button fa" href="#toggle-sub-section" onclick="ToggleSubSection(this, '+n+'); return false;" title="Toggle sub-sections" data-open="false"></a>'),s[i].insertAdjacentHTML("afterend",'<ul style="display:none;"></ul>'),s[i].parentNode.className+=" noBullet");if(e.ToggleSubSection=function(e,t){var a=e.parentNode.lastChild;if(!a.innerHTML){for(var i=r.querySelectorAll("#exercises-"+t+" h3"),c=0,n=i.length,o="";c<n;c++)o+='<li><a href="#'+i[c].id+'">'+i[c].innerHTML.replace(/\s\(.*\)$/,"").replace(/<a.*?>.*?<\/a>/g,"")+"</a></li>";a.innerHTML=o}/none/.test(a.style.display)?(a.style.display="block",e.dataset.open=!0):(a.style.display="none",e.dataset.open=!1)},AddJumpArrowsTo(".lesson-title","quick-nav","Jump to Quick Navigation"),storageOK&&localStorage.Results){var o,s,l=JSON.parse(localStorage.Results)[/lessons-3rd/.test(e.location.pathname)?"3rd":"2nd"];for(o in l)(s=r.querySelector('a[href*="'+o+'"]'))&&s.parentNode.insertAdjacentHTML("beforeend",'&nbsp;<span class="exercise-results result--'+(100==l[o]?"perfect":l[o]>=70?"good":l[o]>=50?"average":"low")+'" title="Exercise score"><i class="fa">'+(100==l[o]?"&#xf005;":l[o]>=70?"&#xf00c;":l[o]>=50?"&#xf10c;":"&#xf00d;")+"</i> "+l[o]+"%</span>")}}(window,document);