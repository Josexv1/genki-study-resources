Genki.tools={type:"",addRow:function(e){for(var t=e.parentNode.cloneNode(!0),o=document.getElementById("study-tool-ui"),n=t.getElementsByTagName("INPUT"),l=n.length;l-- >0;)n[l].value="";o.appendChild(t),o.scrollTop=9999,this.updateJSON()},removeRow:function(e){document.getElementById("study-tool-ui").removeChild(e.parentNode),this.updateJSON()},updateUI:function(){var e=document.getElementById("study-tool-json");e.value||(e.value='{"":""}');var t,o=JSON.parse(e.value),n='<button class="button" title="add another word" onclick="Genki.tools.addRow(this);"><i class="fa">&#xf067;</i></button><button class="button" title="remove word" onclick="Genki.tools.removeRow(this);"><i class="fa">&#xf068;</i></button>',l="";if("vocab"==this.type)for(t in o)l+='<li class="item-row"><input type="text" placeholder="word/kanji" oninput="Genki.tools.updateJSON();" value="'+(/\|/.test(t)?t.split("|")[0]:t)+'">&nbsp;<input type="text" placeholder="furigana (optional)" oninput="Genki.tools.updateJSON();" value="'+(/\|/.test(t)?t.split("|")[1]:"")+'">&nbsp;<input type="text" placeholder="definition/kana" oninput="Genki.tools.updateJSON();" value="'+o[t]+'">&nbsp;'+n+"</li>";else if("spelling"==this.type)for(t in o)l+='<li class="item-row"><input type="text" placeholder="word/kanji" oninput="Genki.tools.updateJSON();" value="'+t+'">&nbsp;<input type="text" placeholder="furigana (optional)" oninput="Genki.tools.updateJSON();" value="'+(o[t]?o[t]:"")+'">&nbsp;'+n+"</li>";document.getElementById("study-tool-ui").innerHTML=l},updateJSON:function(){var e,t,o=document.getElementById("study-tool-ui").getElementsByTagName("LI"),n=0,l=o.length,i={};if("vocab"==this.type)for(;n<l;n++)i[(e=o[n].getElementsByTagName("INPUT"))[0].value+(e[1].value?"|"+e[1].value:"")]=e[2].value;else if("spelling"==this.type)for(;n<l;n++)i[(e=o[n].getElementsByTagName("INPUT"))[0].value]=e[1].value;t=document.getElementById("prettyCode").checked?JSON.stringify(i,"","  "):JSON.stringify(i),document.getElementById("study-tool-json").value=t,window.localStorage[{vocab:"customVocab",spelling:"customSpelling"}[this.type]]=t},restore:function(){var e={vocab:"customVocab",spelling:"customSpelling"}[this.type];window.localStorage[e]?(document.getElementById("study-tool-json").value=window.localStorage[e],this.updateUI(),this.updateJSON()):this.updateJSON()},study:function(){if(document.getElementById("noStudyWarning").checked||confirm('Are you sure you\'re ready to study? Your custom exercise will be temporarily saved to the browser cache, however, if you want to use it again later, click "cancel", then copy the code and save it to a text document. (click "do not warn me" to disable this message)')){var e=document.getElementById("study-tool-json").value;document.getElementById("study-tool-editor").style.display="none",document.getElementById("exercise").style.display="","vocab"==this.type?Genki.generateQuiz({type:"drag",info:"Match the definition/kana to the word/kanji.",quizlet:JSON.parse(e)}):"spelling"==this.type&&Genki.generateQuiz({type:"writing",info:"Practice spelling the following words.",columns:+document.getElementById("spellingColumns").value,quizlet:JSON.parse(e)})}},settings:{prettify:function(e){this.handleCheckbox(e),Genki.tools.updateJSON()},handleCheckbox:function(e,t){t?e.checked="true"==t:window.localStorage[e.id]=e.checked},restore:function(){for(var e=["noStudyWarning","prettyCode"],t=0,o=e.length;t<o;t++)window.localStorage[e[t]]&&this.handleCheckbox(document.getElementById(e[t]),window.localStorage[e[t]])}}};